===================================================================
RCS file: /cvsroot/installer/poldek/vfile/misc.c,v
retrieving revision 1.11
retrieving revision 1.12
diff -u -r1.11 -r1.12
--- installer/poldek/vfile/misc.c	2005/07/17 15:04:34	1.11
+++ installer/poldek/vfile/misc.c	2005/11/02 19:45:40	1.12
@@ -11,7 +11,7 @@
 */
 
 /*
-  $Id$
+  $Id$
 */
 #ifdef HAVE_CONFIG_H
 # include "config.h"
@@ -58,7 +58,7 @@
     
     p = path;
     p++;
-    ndots = 0;
+    ndots = -1;
     
     while (*p) {
         switch (*p) {
@@ -71,11 +71,12 @@
                 break;
 
             case '.':
-                ndots++;
+                if (ndots >= 0)
+                    ndots++;
                 break;
 
             default:
-                ndots = 0;
+                ndots = -1;
                 
                 if (!isalnum(*p) && strchr("-+/._@!~", *p) == NULL) {
                     vf_logerr("%s:%c non alphanumeric characters not allowed\n",
