Index: cli/cli.c
===================================================================
RCS file: /cvsroot/poldek/poldek/cli/cli.c,v
retrieving revision 1.44
diff -u -r1.44 cli/cli.c
--- cli/cli.c	3 Feb 2008 18:01:59 -0000	1.44
+++ cli/cli.c	20 Apr 2008 11:41:01 -0000
@@ -731,9 +731,12 @@
                          const char *cmdline, struct cmd_pipe *cmd_pipe) 
 {
     tn_array              *cmd_chain;
-    int                   rc = 0, i;
+    int                   rc = 0, i, _verbose;
 
     DBGF("%s\n", cmdline);
+
+    /* keep verbose setting as it changes when '-q' option is used */
+    _verbose = poldek_verbose ();
     
     cmd_chain = poclidek_prepare_cmdline(cctx, cmdline);
     if (cmd_chain == NULL)
@@ -753,7 +756,10 @@
         else
             rc = poclidek_exec_cmd_ent(cctx, ts, ent, NULL);
     }
-    
+
+    /* restore verbose setting */
+    poldek_set_verbose (_verbose);
+
     n_array_free(cmd_chain);
     return rc;
 }
Index: cli/shell.c
===================================================================
RCS file: /cvsroot/poldek/poldek/cli/shell.c,v
retrieving revision 1.34
diff -u -r1.34 cli/shell.c
--- cli/shell.c	3 Feb 2008 18:01:59 -0000	1.34
+++ cli/shell.c	20 Apr 2008 11:41:02 -0000
@@ -405,8 +405,6 @@
                 
         s = n_str_strip_ws(line);
         if (*s) {
-            int _verbose = poldek_verbose();
-            
             shInCmd = 1;
             DBGF("(%s)\n", s);
 
@@ -417,8 +415,6 @@
             sigint_reset();
             shDone = 0;
             shInCmd = 0;
-
-            poldek_set_verbose(_verbose);
         }
         free(line);
         
